# Memory
 

## 1. 什么是Memory？
Memory是计算机中重要的部件之一，它是与CPU进行沟通的桥梁。计算机中所有程序的运行都是在内存中进行的，因此Memory的性能对计算机的影响非常大。内存(Memory)也被称为内存储器，其作用是用于暂时存放CPU中的运算数据，以及与硬盘等外部存储器交换的数据。只要计算机在运行中，CPU就会把需要运算的数据调到Memory中进行运算，当运算完成后CPU再将结果传送出来，Memory的运行也决定了计算机的稳定运行。 Memory是由内存芯片、电路板、金手指等部分组成的。

## 2. Types

### 2.1 只读存储器（ROM）

ROM表示只读存储器（Read Only Memory），在制造ROM的时候，信息（数据或程序）就被存入并永久保存。ROM一般用于存放计算机的基本程序和数据，如BIOS ROM。其物理外形一般是双列直插式（DIP）的集成块。

> Cons:
这些信息只能读出，一般不能写入。

> Pros:
即使机器停电，这些数据也不会丢失。



### 2.2 随机存储器（RAM）  
随机存储器（Random Access Memory）表示既可以从中读取数据，也可以写入数据。

> Cons: 当机器电源关闭时，存于其中的数据就会丢失。

> Pros: 既可以从中读取数据，也可以写入数据。

两种广泛使用的现代RAM形式是静态RAM（SRAM）和动态RAM（DRAM） 
- #### 2.2.1 SRAM
在SRAM中，使用六晶体管存储器单元的状态存储一些数据。

> Cons:这种形式的RAM生产成本更高

> Pros:但通常比DRAM更快并且需要更少的动态功率。

在现代计算机中，SRAM通常用作CPU的高速缓冲存储器。

- #### 2.2.2 DRAM
DRAM使用晶体管和电容器对存储一些数据，它们一起构成DRAM单元。电容器保持高或低电荷（分别为1或0），晶体管充当开关，让芯片上的控制电路读取电容器的充电状态或改变它。

> Pros:由于这种形式的存储器比静态RAM更便宜，因此它是现代计算机中使用的计算机存储器的主要形式。

> Cons:更高的功率。
 

静态和动态RAM都被认为是易失性的，因为当从系统断电时它们的状态会丢失或重置。


## 3.Technology Development
#### - 内存条
内存芯片的状态一直沿用到286初期，鉴于它存在着无法拆卸更换的弊病，这对于计算机的发展造成了现实的阻碍。有鉴于此，内存条便应运而生了。将内存芯片焊接到事先设计好的印刷线路板上，而电脑主板上也改用内存插槽。这样就把内存难以安装和更换的问题彻底解决了。

#### - DDR
DDRS(Double Data Rate SDRAM）简称DDR，也就是“双倍速率SDRAM”的意思。DDR可以说是SDRAM的升级版本，DDR在时钟信号上升沿与下降沿各传输一次数据，这使得DDR的数据传输速度为传统SDRAM的两倍。由于仅多采用了下降缘信号，因此并不会造成能耗增加。至于定址与控制信号则与传统SDRAM相同，仅在时钟上升缘传输。

#### - DDR2

1.    封装发热量
DDR内存通常采用TSOP芯片封装形式，这种封装形式可以很好的工作在200MHz上，当频率更高时，它过长的管脚就会产生很高的阻抗和寄生电容，这会影响它的稳定性和频率提升的难度。这也就是DDR的核心频率很难突破275MHZ的原因。而DDR2内存均采用FBGA封装形式。不同于目前广泛应用的TSOP封装形式，FBGA封装提供了更好的电气性能与散热性，为DDR2内存的稳定工作与未来频率的发展提供了良好的保障。 DDR2内存采用1.8V电压，相对于DDR标准的2.5V，降低了不少，从而提供了明显的更小的功耗与更小的发热量。

1.   OCD（Off-Chip Driver）：
也就是所谓的离线驱动调整，DDR II通过OCD可以提高信号的完整性。DDR II通过调整上拉（pull-up）/下拉（pull-down）的电阻值使两者电压相等。使用OCD通过减少DQ-DQS的倾斜来提高信号的完整性；通过控制电压来提高信号品质。

1. ODT：
ODT是内建核心的终结电阻器。DDR SDRAM的主板上面为了防止数据线终端反射信号需要大量的终结电阻。它大大增加了主板的制造成本。实际上，不同的内存模组对终结电路的要求是不一样的，终结电阻的大小决定了数据线的信号比和反射率，终结电阻小则数据线信号反射低但是信噪比也较低；终结电阻高，则数据线的信噪比高，但是信号反射也会增加。因此主板上的终结电阻并不能非常好的匹配内存模组，还会在一定程度上影响信号品质。DDR2可以根据自己的特点内建合适的终结电阻，这样可以保证最佳的信号波形。使用DDR2不但可以降低主板成本，还得到了最佳的信号品质，这是DDR不能比拟的。

1. Post CAS
Post CAS：它是为了提高DDR II内存的利用效率而设定的。在Post CAS操作中，CAS信号（读写/命令）能够被插到RAS信号后面的一个时钟周期，CAS命令可以在附加延迟（Additive Latency）后面保持有效。原来的tRCD（RAS到CAS和延迟）被AL（Additive Latency）所取代，AL可以在0，1，2，3，4中进行设置。由于CAS信号放在了RAS信号后面一个时钟周期，因此ACT和CAS信号永远也不会产生碰撞冲突。

#### - DDR3

1.  突发长度（Burst Length，BL）
由于DDR3的预取为8bit， DDR2是4

1. 寻址时序（Timing）
就像DDR2从DDR转变而来后延迟周期数增加一样，DDR3的CL周期也将比DDR2有所提高。DDR2的CL范围一般在2～5之间，而DDR3则在5～11之间。
1.  重置（Reset）
重置是DDR3新增的一项重要功能，并为此专门准备了一个引脚当Reset命令有效时，DDR3内存将停止所有操作，并切换至最少量活动状态，以节约电力。

1. DDR3新增ZQ校准功能
ZQ也是一个新增的脚，在这个引脚上接有一个240欧姆的低公差参考电阻。这个引脚通过一个命令集，通过片上校准引擎（On-Die Calibration Engine，ODCE）来自动校验数据输出驱动器导通电阻与ODT的终结电阻值。当系统发出这一指令后，将用相应的时钟周期（在加电与初始化之后用512个时钟周期，在退出自刷新操作后用256个时钟周期、在其他情况下用64个时钟周期）对导通电阻和ODT电阻进行重新校准。
1.  参考电压分成两个
在DDR3系统中，对于内存系统工作非常重要的参考电压信号VREF将分为两个信号，即为命令与地址信号服务的VREFCA和为数据总线服务的VREFDQ，这将有效地提高系统数据总线的信噪等级。

#### - DDR4
 DDR4相比DDR3最大的区别有三点：
 
1.  16bit预取机制（DDR3为8bit），同样内核频率下理论速度是DDR3的两倍；
 
1.  更可靠的传输规范，数据可靠性进一步提升；
 
1.  工作电压降为1.2V，更节能。

## 4.Key indicators 

### 4.1 容量：
内存的种类和运行频率会对性能有一定影响，不过相比之下，容量的影响更加大。在其他配置相同的条件下内存越大机器性能也就越高。

内存的工作原理。从功能上理解，我们可以将内存看作是内存控制器与CPU之间的桥梁，内存也就相当于“仓库”。显然，内存的容量决定“仓库”的大小，而内存的速度决定“桥梁”的宽窄，两者缺一不可，这也就是我们常常说道的“内存容量”与“内存速度”。

当内存容量不足，我们运行程序的数据不能调用到内存上运行，就会造成明显的卡顿感，因为内存这座“仓库”空间不够，里面的人已经很多了，想要运行其他程序只能等待里面运行的程序数据先停止运行调出内存。

### 4.2 频率：
内存主频和CPU主频一样，习惯上被用来表示内存的速度，它代表着该内存所能达到的最高工作频率。内存主频越高在一定程度上代表着内存所能达到的速度越快。
 
计算机系统的时钟速度是以频率来衡量的。内存频率越高，他们时钟速度也越快，反应越灵敏，自然就更好。但和CPU、GPU不同的是，我们平常说的内存频率是内存的等效频率，而不是内存颗粒实际频率。

晶体振荡器控制着时钟速度，在石英晶片上加上电压，其就以正弦波的形式震动起来，这一震动可以通过晶片的形变和大小记录下来。晶体的震动以正弦调和变化的电流的形式表现出来，这一变化的电流就是时钟信号。而内存本身并不具备晶体振荡器，因此内存工作时的时钟信号是由主板芯片组的北桥或直接由主板的时钟发生器提供的，也就是说内存无法决定自身的工作频率，其实际工作频率是由主板来决定的。

我们可以看到当内存预读取不同，最终的等效速度就有很大的差别，DDR预读取2bit，DDR2预读取4bit，DDR3预读取8bit,DDR4是16bit，所以在内存颗粒的核心频率相同的时候，DDR的等效频率是颗粒核心频率的两倍，DDR2是四倍，DDR3是八倍，DDR4是16倍，也因此DDR4到来让内存等效频率上了一个台阶。而内存等效频率就是内存的最终速度，是反映内存性能的最终体现，同一条内存下频率越高性能越好。

### 4.3 带宽：
 内存带宽的计算方法并不复杂，大家可以遵循如下的计算公式：带宽=总线宽度×总线频率×一个时钟周期内交换的数据包个数。很明显，在这些乘数因子中，每个都会对最终的内存带宽产生极大的影响。 
 
 除了内存容量与内存速度，延时周期也是决定其性能的关键。当CPU需要内存中的数据时，它会发出一个由内存控制器所执行的要求，内存控制器接著将要求发送至内存，并在接收数据时向CPU报告整个周期（从CPU到内存控制器，内存再回到CPU）所需的时间。毫无疑问，缩短整个周期也是提高内存速度的关键，这就好比在桥梁上工作的警察，其指挥疏通能力也是决定通畅度的因素之一。更快速的内存技术对整体性能表现有重大的贡献，但是提高内存带宽只是解决方案的一部分，数据在CPU以及内存间传送所花的时间通常比处理器执行功能所花的时间更长，为此缓冲区被广泛应用。其实，所谓的缓冲器就是CPU中的一级缓存与二级缓存，它们是内存这座“大桥梁”与CPU之间的“小桥梁”。 
 
 
 
### 4.4 单双通道
单条内存是由64bit的内存控制器控制的，双通道内存的意思就是使用两个64bit内存控制器分别控制两条内存，CPU可分别通过这两条内存寻址、读取数据，从而使内存的理论带宽增加一倍，理论数据存取速度也相应增加一倍，就好比马路由单车道变成双车道，这时两辆车可以同时通过而无需等待。

 
 

## 5. My comment
### 如何选购内存
##### 1、内存的品牌

对于选择内存来说，最重要的是稳定性和性能，而内存的做工水平直接会影响到性能、稳定以及超频。
内存颗粒的好坏直接影响到内存的性能，可以说也是内存最重要的核心元件。所以在购买时，尽量选择大厂生产出来的内存颗粒，一般常见的内存颗粒厂商有三星、现代、镁光、南亚、茂矽等，它们都是经过完整的生产工序，因此在品质上都更有保障。而采用这些顶级大厂内存颗粒的内存条品质性能，必然会比其他杂牌内存颗粒的产品要高出许多，金士顿属于大众化品牌，市场占有率最高，是绝大数用户装机首选品牌，高端机建议海盗船、芝奇等也是不错之选，如果注重性价比可以优先考虑威刚、镁光、英睿达、十铨、宇瞻、影驰等内存品牌。
内存PCB电路板的作用是连接内存芯片引脚与主板信号线，因此其做工好坏直接关系着系统稳定性。目前主流内存PCB电路板层数一般是6层，这类电路板具有良好的电气性能，可以有效屏蔽信号干扰。而更优秀的高规格内存往往配备了8层PCB电路板，以起到更好的效能。
　　

##### 2、内存的容量

作为普通消费者而言，内存容量首先是要确保的，内存容量不足会严重影响日常使用体验，而后面说的频率、时序等只是让内存性能更强，我们要“先吃饱，在考虑吃不吃得好。”
　　现在市场上内存容量一般为4G、8G、16G的单条，如果装机用户想要更大的内存可以通过购买多条同品牌同型号的内存进行组建即可，一般常见主板都是两根、四根内存插槽，一些高端主板会更多内存插槽支持。现在主流主板最高能够支持64G内存，而一些高端主板，甚至能够支持128G超大内存，而64位的处理器最大支持内存也就是128G。
　现在对于普通办公电脑来说，8G内存足以，而游戏电脑建议双8G或者16G，而对于一些规划人员或者运算程序的用户，我们可以考虑适当的按需提升。
　

##### 3、内存的代数

现在选DDR4比较好

#####  4、内存的频率 
 
 在相同代数和容量的内存情况下，内存频率越高，则性能就会越高，不过频率越高内存价位随之越高。
 内存的综合性能可以用频率除以CL值得到的数值比较，这个数值能衡量内存的综合性能。但是在日常使用上，频率提升带来性能的提升会比CL值缩小带来性能的提升要大，因此我们在预算有限的情况下，优先考虑内存频率的高低。

##### 5、双通道内存

　　所谓的双通道内存技术，就是一种可以使得电脑的性能进一步提升的手段。简单来说，两个内存由串联方式改良为并联方式，能够得到更大的内存带宽，从而提升内存的速度。在内存单双通道上，建议大家还是选择双通道，比如我要购买8GB内存，可以选择两条4GB，这样价格虽然贵了几十块，但是对于性能提升还是值得的。在时序上，当内存频率足够高了，比如我已经决定购买3200MHz的内存条，那么在都是3200MHz不同品牌内存条里，我们就要开始考虑时序了，这时候时序好坏才是内存的短板。




## 6. Reference


《内存》 百度百科
https://baike.baidu.com/item/%E5%86%85%E5%AD%98/103614?fr=aladdin

《Random access memory》 维基百科
https://en.wikipedia.org/wiki/Random-access_memory#Types
https://product.pconline.com.cn/itbk/software/dnyw/1802/10845084.html

《DDR4内存》 百度百科
https://baike.baidu.com/item/DDR4%E5%86%85%E5%AD%98?fromtitle=DDR4&fromid=10627930

《怎样挑选内存》 百度经验
https://jingyan.baidu.com/article/c85b7a645b0599003bac95a6.html

《关于怎么选购内存 你想知道的都在这里！》
https://baijiahao.baidu.com/s?id=1596413897685202532&wfr=spider&for=pc

《如何挑选合适内存 内存选购技巧介绍【详解】》https://product.pconline.com.cn/itbk/software/dnyw/1802/10845084.html


